(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[339],{3017:(e,t,l)=>{Promise.resolve().then(l.bind(l,3519))},3519:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>i});var s=l(5155),a=l(2115),o=l(3464);function i(){let[e,t]=(0,a.useState)(null),[l,i]=(0,a.useState)(""),[n,r]=(0,a.useState)({latitude:null,longitude:null}),[c,d]=(0,a.useState)(null),[u,m]=(0,a.useState)(""),[x,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{r({latitude:e.coords.latitude,longitude:e.coords.longitude})},e=>{console.error("Geolocation error:",e.code,e.message),d("Failed to get location: ".concat(e.message," (Code: ").concat(e.code,")"))},{timeout:3e4,enableHighAccuracy:!0,maximumAge:0}):d("Geolocation is not supported by this browser.")},[]);let b=async s=>{s.preventDefault(),console.log({file:e?e.name:"No file uploaded",vehicleNumber:l,location:n});let a=new FormData;a.append("vehicleNumber",l),e&&a.append("photo",e),a.append("latitude",n.latitude||""),a.append("longitude",n.longitude||"");try{let e=await o.A.post("http://localhost:3080/submit-checkpoint",a,{headers:{"Content-Type":"multipart/form-data"},timeout:5e3});console.log("Data submitted successfully to the database"),m("Checkpoint submitted successfully!"),h(e.data.city)}catch(e){console.error("Error submitting data to the database:",e),m("Failed to submit checkpoint. Please try again.")}t(null),i("")};return(0,s.jsx)("div",{className:"h-full bg-blue-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-4 w-full max-w-lg sm:max-w-xl md:max-w-2xl",children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-center text-blue-700 mb-4",children:"Vehicle Checkpoint Form"}),u&&(0,s.jsx)("p",{className:"text-center text-sm mb-4 ".concat(u.includes("successfully")?"text-green-500":"text-red-500"),children:u}),(0,s.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center border-2 border-dashed border-blue-300 rounded-md p-4 bg-blue-50",children:[(0,s.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer text-blue-600 font-medium text-sm",children:[e?e.name:"Click to capture or upload image or video",(0,s.jsx)("input",{id:"file-upload",type:"file",accept:"image/*,video/*",capture:"environment",className:"hidden",onChange:e=>{t(e.target.files[0])}})]}),e&&(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["File selected: ",(0,s.jsx)("strong",{children:e.name})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"vehicle-number",className:"block text-gray-700 font-medium text-sm mb-1",children:"Vehicle Number"}),(0,s.jsx)("input",{id:"vehicle-number",type:"text",value:l,onChange:e=>i(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-400 focus:outline-none text-sm",placeholder:"e.g., ABC-1234",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-700 font-medium text-sm mb-1",children:"Current Location (Optional)"}),c?(0,s.jsxs)("p",{className:"text-red-500 text-sm",children:[c,". Please ensure location services are enabled on your device."]}):n.latitude&&n.longitude?(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"text-gray-600 text-sm",children:["Latitude: ",n.latitude,", Longitude: ",n.longitude]}),x&&(0,s.jsxs)("p",{className:"text-gray-600 text-sm",children:["City: ",x]})]}):(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"Unable to fetch location"})]}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded-md font-semibold hover:bg-blue-700 transition-all duration-200 text-sm",children:"Submit"})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[464,441,684,358],()=>t(3017)),_N_E=e.O()}]);