{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/anuda/Desktop/CS%20research%20web/cs-research/front/my-app/src/app/%28police%29/Attendance/page.js"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nexport default function AttendanceTable() {\r\n  const [attendanceData, setAttendanceData] = useState([]);\r\n  const [message, setMessage] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [lastResetDate, setLastResetDate] = useState(null);\r\n\r\n  useEffect(() => {\r\n    \r\n    const today = new Date().toISOString().split('T')[0]; \r\n    const storedDate = localStorage.getItem('lastResetDate');\r\n\r\n    if (storedDate !== today) {\r\n      \r\n      fetchAttendanceData();\r\n      localStorage.setItem('lastResetDate', today);\r\n      setLastResetDate(today);\r\n    } else {\r\n      \r\n      fetchAttendanceData();\r\n      setLastResetDate(storedDate);\r\n    }\r\n  }, []);\r\n\r\n  const fetchAttendanceData = async () => {\r\n    try {\r\n      const response = await axios.get('http://localhost:3080/attendance-records');\r\n      if (response.status === 200) {\r\n       \r\n        const initializedData = response.data.map(record => ({\r\n          ...record,\r\n          Attendace: false, \r\n        }));\r\n        setAttendanceData(initializedData);\r\n      } else {\r\n        setError('Failed to fetch attendance data');\r\n      }\r\n    } catch (err) {\r\n      setError('Something went wrong while fetching attendance data');\r\n    }\r\n  };\r\n\r\n  const handleAttendanceChange = (id, newAttendance) => {\r\n    setAttendanceData(attendanceData.map(record =>\r\n      record.ID === id ? { ...record, Attendace: newAttendance } : record\r\n    ));\r\n  };\r\n\r\n  const handleSubmitAttendance = async () => {\r\n    try {\r\n      const response = await axios.put('http://localhost:3080/update-attendance', attendanceData, {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n      });\r\n\r\n      if (response.status === 200) {\r\n        setMessage(response.data.message);\r\n        setAttendanceData(attendanceData.map(record => ({\r\n          ...record,\r\n          Attendace: false,\r\n        })));\r\n        setTimeout(() => setMessage(''), 3000); \r\n      } else {\r\n        setError(response.data.error);\r\n      }\r\n    } catch (err) {\r\n      setError(err.response?.data?.error || 'Failed to submit attendance');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen p-6 bg-gray-100\">\r\n      <h1 className=\"text-2xl font-bold mb-6 text-center\">HR Attendance Management</h1>\r\n      {message && <p className=\"mt-4 text-green-600 text-center\">{message}</p>}\r\n      {error && <p className=\"mt-4 text-red-600 text-center\">{error}</p>}\r\n      <div className=\"overflow-x-auto\">\r\n        <table className=\"min-w-full bg-white border border-gray-300\">\r\n          <thead>\r\n            <tr className=\"bg-gray-200\">\r\n              <th className=\"py-2 px-4 border-b\">Name</th>\r\n              <th className=\"py-2 px-4 border-b\">ID</th>\r\n              <th className=\"py-2 px-4 border-b\">Attendance</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {attendanceData.map((record) => (\r\n              <tr key={record.ID} className=\"hover:bg-gray-100\">\r\n                <td className=\"py-2 px-4 border-b\">{record.name}</td>\r\n                <td className=\"py-2 px-4 border-b\">{record.ID}</td>\r\n                <td className=\"py-2 px-4 border-b\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={record.Attendace || false}\r\n                    onChange={(e) => handleAttendanceChange(record.ID, e.target.checked)}\r\n                    className=\"h-5 w-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\r\n                  />\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n      {attendanceData.length === 0 && <p className=\"mt-4 text-center\">No attendance records found.</p>}\r\n      <div className=\"mt-6 text-center\">\r\n        <button\r\n          onClick={handleSubmitAttendance}\r\n          className=\"bg-blue-500 text-white px-6 py-2 rounded-md hover:bg-blue-600 transition\"\r\n        >\r\n          Submit Attendance\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}