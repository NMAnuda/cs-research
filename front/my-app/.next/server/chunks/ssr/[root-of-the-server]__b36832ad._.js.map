{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/anuda/Desktop/CS%20research%20web/cs-research/front/my-app/src/app/%28police%29/viewreport/page.js"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport Head from \"next/head\";\r\nimport jsPDF from \"jspdf\";\r\nimport autoTable from \"jspdf-autotable\";\r\n\r\nconst MonthlySummary = () => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [checkpoints, setCheckpoints] = useState([]);\r\n  const [attendanceSummary, setAttendanceSummary] = useState([]);\r\n  const [selectedMonth, setSelectedMonth] = useState(new Date().getMonth() + 1); // 1-12\r\n  const [selectedYear, setSelectedYear] = useState(new Date().getFullYear());\r\n\r\n  // Fetch summary data\r\n  const fetchSummary = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await axios.get('http://localhost:3080/monthly-summary', {\r\n        params: { month: selectedMonth, year: selectedYear },\r\n      });\r\n      const { checkpoints, attendanceSummary } = response.data;\r\n      setCheckpoints(checkpoints.map(item => ({\r\n        ...item,\r\n        date: new Date(item.createdAt).toISOString().slice(0, 10),\r\n      })));\r\n      setAttendanceSummary(attendanceSummary.map(item => ({\r\n        ...item,\r\n        date: new Date(item.date).toISOString().slice(0, 10),\r\n      })));\r\n    } catch (error) {\r\n      console.error(\"Error fetching summary data:\", error);\r\n      setError(error.message);\r\n      setCheckpoints([]);\r\n      setAttendanceSummary([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchSummary();\r\n  }, [selectedMonth, selectedYear]);\r\n\r\n  // Generate PDF report\r\n  const generatePDFReport = () => {\r\n    try {\r\n      const doc = new jsPDF();\r\n\r\n      // Title\r\n      doc.setFontSize(18);\r\n      doc.text(\r\n        `Monthly Police Dashboard Summary - ${new Date(0, selectedMonth - 1).toLocaleString('default', { month: 'long' })} ${selectedYear}`,\r\n        14,\r\n        20\r\n      );\r\n\r\n      // Checkpoint Summary\r\n      doc.setFontSize(14);\r\n      doc.text(\"Checkpoint Summary\", 14, 30);\r\n      const checkpointBody = checkpoints.map(item => [\r\n        item.vehicleNumber || \"N/A\",\r\n        item.city || \"N/A\",\r\n        item.date || \"N/A\",\r\n        item.actionTaken || \"Pending\",\r\n        item.photoPath || \"No Image\",\r\n      ]);\r\n      autoTable(doc, {\r\n        startY: 35,\r\n        head: [[\"Vehicle Number\", \"City\", \"Date\", \"Action Taken\", \"Image Path\"]],\r\n        body: checkpointBody,\r\n      });\r\n\r\n      // Attendance Summary\r\n      const finalYCheckpoints = doc.lastAutoTable?.finalY || 35;\r\n      doc.setFontSize(14);\r\n      doc.text(\"Attendance Summary\", 14, finalYCheckpoints + 10);\r\n      const attendanceBody = attendanceSummary.map(item => [\r\n        item.name || \"N/A\",\r\n        item.city || \"N/A\",\r\n        item.date || \"N/A\",\r\n      ]);\r\n      autoTable(doc, {\r\n        startY: finalYCheckpoints + 15,\r\n        head: [[\"Name\", \"City\", \"Date\"]],\r\n        body: attendanceBody,\r\n      });\r\n\r\n      // Save PDF\r\n      doc.save(`Police_Dashboard_Summary_${selectedYear}_${selectedMonth}.pdf`);\r\n    } catch (error) {\r\n      console.error(\"Error generating PDF report:\", error);\r\n      setError(\"Failed to generate PDF report: \" + error.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-white flex flex-col items-center py-8\">\r\n      <Head>\r\n        <title>Monthly Police Dashboard Summary</title>\r\n        <script src=\"https://cdn.tailwindcss.com\"></script>\r\n      </Head>\r\n      <div className=\"w-full max-w-7xl px-4 sm:px-6 lg:px-8\">\r\n        {/* Header */}\r\n        <div className=\"bg-white shadow-lg rounded-lg p-6 mb-8 border border-black\">\r\n          <h1 className=\"text-3xl font-bold text-black text-center\">Monthly Police Dashboard Summary</h1>\r\n          <p className=\"text-black text-center mt-2\">View and download monthly checkpoint and attendance summaries.</p>\r\n        </div>\r\n\r\n        {/* Loading and Error States */}\r\n        {loading && (\r\n          <div className=\"bg-white shadow-lg rounded-lg p-6 w-full text-center border border-black\">\r\n            <p className=\"text-black text-lg\">Loading data...</p>\r\n          </div>\r\n        )}\r\n        {error && (\r\n          <div className=\"bg-white shadow-lg rounded-lg p-6 w-full text-center border border-black\">\r\n            <p className=\"text-red-600 text-lg\">Error: {error}</p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Main Content */}\r\n        {!loading && (\r\n          <div className=\"space-y-8\">\r\n            {/* Month and Year Selection and Download Button */}\r\n            <div className=\"bg-white shadow-lg rounded-lg p-6 flex flex-col sm:flex-row items-center justify-between gap-4 border border-black\">\r\n              <div className=\"flex items-center gap-3 w-full sm:w-auto\">\r\n                <label htmlFor=\"monthSelect\" className=\"text-black font-medium text-sm sm:text-base\">\r\n                  Select Month:\r\n                </label>\r\n                <select\r\n                  id=\"monthSelect\"\r\n                  value={selectedMonth}\r\n                  onChange={(e) => setSelectedMonth(parseInt(e.target.value))}\r\n                  className=\"w-full sm:w-auto p-2.5 border border-black rounded-lg text-black text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200\"\r\n                >\r\n                  {Array.from({ length: 12 }, (_, i) => (\r\n                    <option key={i + 1} value={i + 1}>\r\n                      {new Date(0, i).toLocaleString('default', { month: 'long' })}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n                <label htmlFor=\"yearSelect\" className=\"text-black font-medium text-sm sm:text-base\">\r\n                  Select Year:\r\n                </label>\r\n                <input\r\n                  id=\"yearSelect\"\r\n                  type=\"number\"\r\n                  value={selectedYear}\r\n                  onChange={(e) => setSelectedYear(parseInt(e.target.value))}\r\n                  className=\"w-full sm:w-auto p-2.5 border border-black rounded-lg text-black text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200\"\r\n                  min=\"2000\"\r\n                  max=\"2100\"\r\n                />\r\n              </div>\r\n              <button\r\n                onClick={generatePDFReport}\r\n                className=\"w-full sm:w-auto px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 flex items-center justify-center gap-2\"\r\n              >\r\n                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"></path>\r\n                </svg>\r\n                Download PDF Report\r\n              </button>\r\n            </div>\r\n\r\n            {/* Checkpoint Data Table */}\r\n            <div className=\"bg-white shadow-lg rounded-lg p-6 border border-black\">\r\n              <h2 className=\"text-xl font-semibold text-black mb-4\">Checkpoint Data</h2>\r\n              {checkpoints.length > 0 ? (\r\n                <div className=\"overflow-x-auto max-h-96 overflow-y-auto custom-scroll\">\r\n                  <table className=\"min-w-full divide-y divide-black\">\r\n                    <thead className=\"bg-gray-100 sticky top-0\">\r\n                      <tr>\r\n                        <th className=\"py-3 px-4 text-left text-sm font-semibold text-black\">Vehicle Number</th>\r\n                        <th className=\"py-3 px-4 text-left text-sm font-semibold text-black\">City</th>\r\n                        <th className=\"py-3 px-4 text-left text-sm font-semibold text-black\">Date</th>\r\n                        <th className=\"py-3 px-4 text-left text-sm font-semibold text-black\">Action Taken</th>\r\n                        <th className=\"py-3 px-4 text-left text-sm font-semibold text-black\">Image Path</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-black\">\r\n                      {checkpoints.map((item, index) => (\r\n                        <tr key={item._id || index} className=\"hover:bg-gray-50 transition duration-150\">\r\n                          <td className=\"py-3 px-4 text-sm text-black\">{item.vehicleNumber}</td>\r\n                          <td className=\"py-3 px-4 text-sm text-black\">{item.city}</td>\r\n                          <td className=\"py-3 px-4 text-sm text-black\">{item.date}</td>\r\n                          <td className=\"py-3 px-4 text-sm text-black\">{item.actionTaken || \"Pending\"}</td>\r\n                          <td className=\"py-3 px-4 text-sm text-black\">{item.photoPath || \"No Image\"}</td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-center text-black text-sm\">No checkpoint data available.</p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Attendance Data Table */}\r\n            <div className=\"bg-white shadow-lg rounded-lg p-6 border border-black\">\r\n              <h2 className=\"text-xl font-semibold text-black mb-4\">Attendance Data</h2>\r\n              {attendanceSummary.length > 0 ? (\r\n                <div className=\"overflow-x-auto max-h-96 overflow-y-auto custom-scroll\">\r\n                  <table className=\"min-w-full divide-y divide-black\">\r\n                    <thead className=\"bg-gray-100 sticky top-0\">\r\n                      <tr>\r\n                        <th className=\"py-3 px-4 text-left text-sm font-semibold text-black\">Name</th>\r\n                        <th className=\"py-3 px-4 text-left text-sm font-semibold text-black\">City</th>\r\n                        <th className=\"py-3 px-4 text-left text-sm font-semibold text-black\">Date</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-black\">\r\n                      {attendanceSummary.map((item, index) => (\r\n                        <tr key={index} className=\"hover:bg-gray-50 transition duration-150\">\r\n                          <td className=\"py-3 px-4 text-sm text-black\">{item.name}</td>\r\n                          <td className=\"py-3 px-4 text-sm text-black\">{item.city}</td>\r\n                          <td className=\"py-3 px-4 text-sm text-black\">{item.date}</td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-center text-black text-sm\">No attendance data available.</p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Custom Scrollbar Styles */}\r\n      <style jsx>{`\r\n        .custom-scroll::-webkit-scrollbar {\r\n          width: 8px;\r\n        }\r\n        .custom-scroll::-webkit-scrollbar-thumb {\r\n          background-color: #a0aec0;\r\n          border-radius: 4px;\r\n        }\r\n        .custom-scroll::-webkit-scrollbar-track {\r\n          background: #edf2f7;\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MonthlySummary;"],"names":[],"mappings":"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","debugId":null}}]
}