{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/anuda/Desktop/CS%20research%20web/cs-research/front/my-app/src/app/%28police%29/viewpolice/page.js"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nexport default function OfficersView() {\r\n  const [officers, setOfficers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [editOfficer, setEditOfficer] = useState(null);\r\n  const [formData, setFormData] = useState({ phoneno: '', name: '', city: '', ID: '' });\r\n  const [message, setMessage] = useState('');\r\n\r\n  const fetchOfficers = async () => {\r\n    try {\r\n      const loggedInCity = localStorage.getItem('loggedInCity');\r\n      if (!loggedInCity) {\r\n        setError('No city selected. Please log in again.');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      const response = await axios.get('http://localhost:3080/attendance-records', {\r\n        params: { city: loggedInCity },\r\n      });\r\n      setOfficers(response.data);\r\n      setLoading(false);\r\n    } catch (error) {\r\n      console.error('Error fetching officers:', error);\r\n      setError('Failed to fetch officers');\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchOfficers();\r\n  }, []);\r\n\r\n  const handleEditClick = (officer) => {\r\n    setEditOfficer(officer);\r\n    setFormData({\r\n      phoneno: officer.phoneno,\r\n      name: officer.name,\r\n      city: officer.city,\r\n      ID: officer.ID,\r\n    });\r\n  };\r\n\r\n  const handleFormChange = (e) => {\r\n    setFormData({ ...formData, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleUpdate = async (e) => {\r\n    e.preventDefault();\r\n    const loggedInCity = localStorage.getItem('loggedInCity');\r\n    if (!loggedInCity) {\r\n      setError('No city selected. Please log in again.');\r\n      return;\r\n    }\r\n    if (formData.city !== loggedInCity) {\r\n      setError('You can only update officers for your logged-in city.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await axios.put(`http://localhost:3080/update-pdetails/${editOfficer._id}`, formData);\r\n      setMessage(response.data.message);\r\n      setOfficers(officers.map(o => (o._id === editOfficer._id ? response.data.officer : o)));\r\n      setEditOfficer(null);\r\n      setTimeout(() => setMessage(''), 3000);\r\n    } catch (error) {\r\n      setError(error.response?.data?.error || 'Failed to update officer');\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    if (confirm('Are you sure you want to delete this officer?')) {\r\n      try {\r\n        const officerToDelete = officers.find(o => o._id === id);\r\n        const loggedInCity = localStorage.getItem('loggedInCity');\r\n        if (!loggedInCity) {\r\n          setError('No city selected. Please log in again.');\r\n          return;\r\n        }\r\n        if (officerToDelete.city !== loggedInCity) {\r\n          setError('You can only delete officers from your logged-in city.');\r\n          return;\r\n        }\r\n        const response = await axios.delete(`http://localhost:3080/delete-pdetails/${id}`);\r\n        setMessage(response.data.message);\r\n        setOfficers(officers.filter(o => o._id !== id));\r\n        setTimeout(() => setMessage(''), 3000);\r\n      } catch (error) {\r\n        setError(error.response?.data?.error || 'Failed to delete officer');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleAddNewOfficer = () => {\r\n    window.location.href = '/Pdetails'; \r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-white p-6\">\r\n      <h1 className=\"text-2xl font-bold mb-6 text-center text-black\">Officers View</h1>\r\n      {message && <p className=\"mb-4 text-green-600 text-center\">{message}</p>}\r\n      {error && <p className=\"mb-4 text-red-500 text-center\">{error}</p>}\r\n\r\n      {/* Officers Table */}\r\n      <div className=\"overflow-x-auto\">\r\n        {loading ? (\r\n          <p className=\"text-black text-center\">Loading...</p>\r\n        ) : officers.length > 0 ? (\r\n          <table className=\"min-w-full border border-black\">\r\n            <thead>\r\n              <tr>\r\n                <th className=\"py-2 px-4 border-b border-black text-black\">Name</th>\r\n                <th className=\"py-2 px-4 border-b border-black text-black\">ID</th>\r\n                <th className=\"py-2 px-4 border-b border-black text-black\">Phone Number</th>\r\n                <th className=\"py-2 px-4 border-b border-black text-black\">City</th>\r\n                <th className=\"py-2 px-4 border-b border-black text-black\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {officers.map((officer) => (\r\n                <tr key={officer._id} className=\"hover:bg-gray-50\">\r\n                  <td className=\"py-2 px-4 border-b border-black text-black\">{officer.name}</td>\r\n                  <td className=\"py-2 px-4 border-b border-black text-black\">{officer.ID}</td>\r\n                  <td className=\"py-2 px-4 border-b border-black text-black\">{officer.phoneno}</td>\r\n                  <td className=\"py-2 px-4 border-b border-black text-black\">{officer.city}</td>\r\n                  <td className=\"py-2 px-4 border-b border-black text-black\">\r\n                    <button\r\n                      onClick={() => handleEditClick(officer)}\r\n                      className=\"bg-blue-500 text-white px-3 py-1 rounded mr-2 hover:bg-blue-600\"\r\n                    >\r\n                      Edit\r\n                    </button>\r\n                    <button\r\n                      onClick={() => handleDelete(officer._id)}\r\n                      className=\"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600\"\r\n                    >\r\n                      Delete\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        ) : (\r\n          <p className=\"text-black text-center\">No officers found</p>\r\n        )}\r\n      </div>\r\n\r\n      {/* Add New Officer Button */}\r\n      <div className=\"mt-6 text-center\">\r\n        <button\r\n          onClick={handleAddNewOfficer}\r\n          className=\"bg-green-500 text-white px-6 py-2 rounded-md hover:bg-green-600 transition\"\r\n        >\r\n          Add New Officer\r\n        </button>\r\n      </div>\r\n\r\n      {/* Edit Modal */}\r\n      {editOfficer && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center\">\r\n          <div className=\"bg-white p-6 rounded-md w-full max-w-md\">\r\n            <h2 className=\"text-xl font-semibold mb-4 text-black\">Edit Officer</h2>\r\n            <div>\r\n              <div className=\"mb-4\">\r\n                <label className=\"block text-black mb-1\">Name</label>\r\n                <input\r\n                  type=\"text\"\r\n                  name=\"name\"\r\n                  value={formData.name}\r\n                  onChange={handleFormChange}\r\n                  className=\"w-full border border-black p-2 rounded text-black\"\r\n                  required\r\n                />\r\n              </div>\r\n              <div className=\"mb-4\">\r\n                <label className=\"block text-black mb-1\">ID</label>\r\n                <input\r\n                  type=\"number\"\r\n                  name=\"ID\"\r\n                  value={formData.ID}\r\n                  onChange={handleFormChange}\r\n                  className=\"w-full border border-black p-2 rounded text-black\"\r\n                  required\r\n                />\r\n              </div>\r\n              <div className=\"mb-4\">\r\n                <label className=\"block text-black mb-1\">Phone Number</label>\r\n                <input\r\n                  type=\"text\"\r\n                  name=\"phoneno\"\r\n                  value={formData.phoneno}\r\n                  onChange={handleFormChange}\r\n                  className=\"w-full border border-black p-2 rounded text-black\"\r\n                  required\r\n                />\r\n              </div>\r\n              <div className=\"mb-4\">\r\n                <label className=\"block text-black mb-1\">City</label>\r\n                <input\r\n                  type=\"text\"\r\n                  name=\"city\"\r\n                  value={formData.city}\r\n                  onChange={handleFormChange}\r\n                  className=\"w-full border border-black p-2 rounded text-black bg-gray-100 cursor-not-allowed\"\r\n                  readOnly // Make city read-only\r\n                />\r\n              </div>\r\n              <div className=\"flex justify-end gap-2\">\r\n                <button\r\n                  onClick={() => setEditOfficer(null)}\r\n                  className=\"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={handleUpdate}\r\n                  className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\"\r\n                >\r\n                  Save\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}